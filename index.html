<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WNJ Designs ‚Äì Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#2f6f59;
  --secondary:#2b2b2b;
  --bg:#f4f6f5;
  --border:#dcdcdc;
}
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:var(--bg);
  color:#222;
}
header{
  background:var(--primary);
  color:#fff;
  padding:12px 20px;
  font-size:20px;
  font-weight:bold;
}
.container{
  padding:20px;
}
button,select,input{
  padding:6px 10px;
  margin:4px;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
  margin-top:10px;
}
th,td{
  border:1px solid var(--border);
  padding:8px;
  text-align:left;
}
th{
  background:#eee;
}
.badge{
  padding:4px 8px;
  border-radius:4px;
  font-size:12px;
}
.done{background:#c8e6c9;}
.pending{background:#ffe0b2;}
.actions button{
  margin-right:4px;
}
.hidden{display:none;}
.dropdown{
  position:relative;
  display:inline-block;
}
.dropdown-content{
  display:none;
  position:absolute;
  background:#fff;
  min-width:160px;
  border:1px solid var(--border);
  z-index:1;
}
.dropdown-content button{
  width:100%;
  border:none;
  background:#fff;
  text-align:left;
}
.dropdown:hover .dropdown-content{
  display:block;
}
.preview-note{
  background:#fff3cd;
  padding:10px;
  margin-bottom:10px;
  border:1px solid #ffeeba;
}
</style>
</head>

<body>

<header>WNJ Designs ‚Äì Admin Dashboard</header>

<div class="container">

<div id="previewNote" class="preview-note hidden">
Client Preview Mode ‚Äì Editing Disabled
</div>

<div>
<button onclick="addClient()">‚ûï Add Client</button>

<div class="dropdown">
<button>üì• Import</button>
<div class="dropdown-content">
<button onclick="importTasks()">Import Tasks (XLSX / TXT / PDF / Plain)</button>
</div>
</div>

<div class="dropdown">
<button>üì§ Export</button>
<div class="dropdown-content">
<button onclick="exportData('xlsx')">Export XLSX</button>
<button onclick="exportData('txt')">Export TXT</button>
<button onclick="exportData('plain')">Export Plain</button>
<button onclick="exportData('pdf')">Export PDF</button>
<button onclick="exportData('word')">Export Word</button>
</div>
</div>

<button onclick="window.print()">üñ® Print</button>
<button onclick="togglePreview()">üëÅ Client Preview</button>
</div>

<div id="clients"></div>

</div>

<script>
let previewMode=false;

let data={
  clients:[]
};

function save(){
  localStorage.setItem("wnj_dashboard",JSON.stringify(data));
}
function load(){
  let d=localStorage.getItem("wnj_dashboard");
  if(d) data=JSON.parse(d);
}
load();

function render(){
  let html="";
  data.clients.forEach((c,ci)=>{
    html+=`
    <h3>
      <span contenteditable="${!previewMode}" onblur="editClient(${ci},this.innerText)">
      ${c.name}
      </span>
      ${previewMode?"":`
      <button onclick="deleteClient(${ci})">üóë</button>
      `}
    </h3>

    <table>
    <tr>
      <th>Sr#</th>
      <th>Task</th>
      <th>Status</th>
      ${previewMode?"":"<th>Move</th><th>Action</th>"}
    </tr>
    `;

    c.tasks.forEach((t,ti)=>{
      html+=`
      <tr>
        <td>${ti+1}</td>
        <td contenteditable="${!previewMode}" onblur="editTask(${ci},${ti},this.innerText)">${t.title}</td>
        <td>
          <span class="badge ${t.status}">
          ${t.status}
          </span>
        </td>
        ${previewMode?"":`
        <td>
          <button onclick="moveTask(${ci},${ti},-1)">‚¨Ü</button>
          <button onclick="moveTask(${ci},${ti},1)">‚¨á</button>
        </td>
        <td class="actions">
          <button onclick="toggleStatus(${ci},${ti})">‚úî</button>
          <button onclick="deleteTask(${ci},${ti})">üóë</button>
        </td>
        `}
      </tr>
      `;
    });

    html+=`</table>`;

    if(!previewMode){
      html+=`
      <button onclick="addTask(${ci})">‚ûï Add Task</button>
      `;
    }
  });
  document.getElementById("clients").innerHTML=html;
  save();
}

function addClient(){
  let n=prompt("Client Name");
  if(!n) return;
  data.clients.push({name:n,tasks:[]});
  render();
}

function editClient(i,val){
  data.clients[i].name=val.trim();
  render();
}

function deleteClient(i){
  let name=data.clients[i].name;
  let confirmName=prompt(`Type "${name}" to confirm delete`);
  if(confirmName===name){
    data.clients.splice(i,1);
    render();
  }
}

function addTask(ci){
  let t=prompt("Task title");
  if(!t) return;
  data.clients[ci].tasks.push({title:t,status:"pending"});
  render();
}

function editTask(ci,ti,val){
  data.clients[ci].tasks[ti].title=val.trim();
  render();
}

function deleteTask(ci,ti){
  data.clients[ci].tasks.splice(ti,1);
  render();
}

function moveTask(ci,ti,dir){
  let arr=data.clients[ci].tasks;
  let ni=ti+dir;
  if(ni<0||ni>=arr.length) return;
  [arr[ti],arr[ni]]=[arr[ni],arr[ti]];
  render();
}

function toggleStatus(ci,ti){
  let t=data.clients[ci].tasks[ti];
  t.status=t.status==="pending"?"done":"pending";
  render();
}

function togglePreview(){
  previewMode=!previewMode;
  document.getElementById("previewNote").classList.toggle("hidden",!previewMode);
  render();
}

function importTasks(){
  let txt=prompt("Paste tasks (comma or new line separated)");
  if(!txt) return;
  if(data.clients.length===0){
    alert("Add client first");
    return;
  }
  let tasks=txt.split(/,|\n/);
  tasks.forEach(t=>{
    if(t.trim()){
      data.clients[0].tasks.push({title:t.trim(),status:"pending"});
    }
  });
  render();
}

function exportData(type){
  let content="";
  data.clients.forEach(c=>{
    content+=c.name+"\n";
    c.tasks.forEach((t,i)=>{
      content+=`${i+1}. ${t.title} [${t.status}]\n`;
    });
    content+="\n";
  });
  let blob=new Blob([content],{type:"text/plain"});
  let a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="wnj_tasks."+type;
  a.click();
}

render();
</script>

</body>
</html>
